C51 COMPILER V9.60.0.0   MAIN                                                              03/13/2021 16:33:24 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE App\main.c OPTIMIZE(0,SPEED) BROWSE INCDIR(..\motor_test;.\App;.\Common;
                    -.\Driver;.\Utilities;C:\Keil_v5\C51\LIB;.\Mid) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2           * Copyright (c) 2021
   3           * Team, JSC.
   4           * All Rights Reserved
   5           *
   6           *
   7           * Description:
   8           *
   9           * Author: Truongvv
  10           *
  11           * Last Changed By:  $Author: Truongvv $
  12           * Revision:         $Revision: 1.0 $
  13           * Last Changed:     $Date: x/x/xxxx $
  14           */
  15          #include "N76E003.h"
  16          #include "SFR_Macro.h"
  17          #include "Function_Define.h"
  18          #include "uart.h"
  19          #include "delay.h"
  20          #include "relay.h"
  21          #include "motor.h"
  22          #include "pwm.h"
  23          #include "queue.h"
  24          /*******************************************************************************
  25           * Definition
  26           ******************************************************************************/
  27          /**/
  28          #define DEFAULTDUTY    15000
  29          #define DEFAULTSPEED   13500
  30          /* Command */
  31          #define START_RUN    0x01
  32          #define STOP_RUN     0x02
  33          #define SPEED_UP     0x03
  34          #define SPEED_DOWN   0x04
  35          
  36          //queue
  37          #define QueueSize  6
  38          /*******************************************************************************
  39           * Variable
  40           ******************************************************************************/
  41          
  42          QUEUEx_t CommandQueue;
  43          u8 CommandBuff[QueueSize];
  44          unsigned int currentDuty=DEFAULTDUTY;
  45          
  46          void handleUart(void)
  47          {
  48   1         static u8 revByte = 0;
  49   1         revByte = UART_RevData();
  50   1         QUEUE_Push(&CommandQueue,&revByte);
  51   1      }
  52          
  53          void main(void)
  54          {
C51 COMPILER V9.60.0.0   MAIN                                                              03/13/2021 16:33:24 PAGE 2   

  55   1          uint8_t buffer;
  56   1          uint16_t currentDuty = DEFAULTDUTY;
  57   1          //delay_ms(10000);
  58   1          //p10 gpio
  59   1          MOTOR_Config();
  60   1          delay_ms(1000);
  61   1          RELAY_Config();
  62   1          RELAY_AC(1);
  63   1          delay_ms(1000);
  64   1          MOTOR_Init(15000);
  65   1      //    QUEUE_Init(&CommandQueue, CommandBuff, QueueSize, sizeof(u8));
  66   1      //    //uart init
  67   1      //    UART_Init(1200);
  68   1      //    UART_CallBackInit(handleUart);
  69   1      //    ENABLE_AllInterrupt();
  70   1      //    UART_Enable();
  71   1            
  72   1      //    MOTOR_SetSpeed(DEFAULTSPEED, DEFAULTDUTY);
  73   1      //    currentDuty = DEFAULTDUTY;
  74   1          while(1)
  75   1          {
  76   2              //
  77   2              MOTOR_SetSpeed(15000, 10000);
  78   2              MOTOR_SetSpeed(10000, 15000);
  79   2      //        if(!QUEUE_Empty(&CommandQueue))
  80   2      //        {
  81   2      //            QUEUE_Get(&CommandQueue,&buffer);
  82   2      //            switch (buffer)
  83   2      //            {
  84   2      //                case START_RUN:
  85   2      //                    MOTOR_SetSpeed(currentDuty,DEFAULTSPEED);
  86   2      //                    currentDuty = DEFAULTSPEED;
  87   2      //                    break;
  88   2      //                case STOP_RUN:
  89   2      //                    MOTOR_SetSpeed(currentDuty,DEFAULTDUTY);
  90   2      //                    currentDuty = DEFAULTDUTY;
  91   2      //                    break;
  92   2      //                case SPEED_UP:
  93   2      //                    if(currentDuty>8000)
  94   2      //                    {
  95   2      //                        MOTOR_SetSpeed(currentDuty,currentDuty-500);
  96   2      //                        currentDuty -= 500;
  97   2      //                    }
  98   2      //                    break;
  99   2      //                case SPEED_DOWN:
 100   2      //                    if(currentDuty<15000)
 101   2      //                    {
 102   2      //                        MOTOR_SetSpeed(currentDuty,currentDuty+500);
 103   2      //                        currentDuty += 500;
 104   2      //                    }
 105   2      //                    break;
 106   2      //                default: 
 107   2      //                    break;
 108   2      //            }
 109   2      //        } 
 110   2          }
 111   1      }
*** WARNING C280 IN LINE 55 OF App\main.c: 'buffer': unreferenced local variable


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    102    ----
C51 COMPILER V9.60.0.0   MAIN                                                              03/13/2021 16:33:24 PAGE 3   

   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     22    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
