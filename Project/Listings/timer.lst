C51 COMPILER V9.60.0.0   TIMER                                                             05/22/2021 13:58:10 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\timer.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\Driver\timer.c LARGE OPTIMIZE(0,SPEED) BROWSE INCDIR(..\App;..\Common
                    -;..\Driver;..\Mid;..\Utilities) DEBUG OBJECTEXTEND PRINT(.\Listings\timer.lst) OBJECT(.\Objects\timer.obj)

line level    source

   1          /*
   2           *  time.c
   3           *
   4           *  Created on: Dec 25, 2020
   5           *      Author: Truong VV
   6           */
   7          
   8          #include "N76E003.h"
   9          #include "SFR_Macro.h"
  10          #include "Function_Define.h"
  11          #include "soft_uart.h"
  12          #include "timer.h"
  13          
  14          /******************************************************************************/
  15          /*                              DECLARE AND DEFINE                                      */
  16          /******************************************************************************/
  17          
  18          type_TimerCallBackFnc p_timerCallBack;
  19          /******************************************************************************/
  20          /*                              FUNCTION                                      */
  21          /******************************************************************************/
  22          /**
  23           * @func   PWM_Start
  24           * @brief  None
  25           * @param  
  26           * @retval None
  27           */
  28          void TIMER_Init(TimerChanel channel,uint16_t baudRate)
  29          {
  30   1          switch (channel)
  31   1          {
  32   2          case TIMER0:
  33   2              CKCON |= (1 << 3); // clock source of Timer 0 is direct the system clock
  34   2              TMOD |= (1 << 0); // timer0 16bit
  35   2              //WARNING
  36   2              // Timer 2 should be used to avoid resetting registers TH0 and TL0 in the handler function
  37   2      
  38   2              TL0 =  0xEA;  // = 65535 - 16000000/1200 = 52202
  39   2              TH0 =  0xCB;  // 65535 - 16000000/1200
  40   2              break;
  41   2          case TIMER1:
  42   2              break;
  43   2          case TIMER2:
  44   2              break;
  45   2          case TIMER3:
  46   2              break;
  47   2          default:
  48   2              break;
  49   2          }
  50   1          TIMER_Disable(TIMER0);
  51   1      }
*** WARNING C280 IN LINE 28 OF ..\Driver\timer.c: 'baudRate': unreferenced local variable
  52          
  53          /**
C51 COMPILER V9.60.0.0   TIMER                                                             05/22/2021 13:58:10 PAGE 2   

  54           * @func   PWM_Start
  55           * @brief  None
  56           * @param  
  57           * @retval None
  58           */
  59          void TIMER_CallBackInit(type_TimerCallBackFnc pHandle)
  60          {
  61   1          p_timerCallBack = pHandle;
  62   1      }
  63          
  64          /**
  65           * @func   PWM_Start
  66           * @brief  None
  67           * @param  
  68           * @retval None
  69           */
  70          void TIMER_Enable(TimerChanel channel)
  71          {
  72   1          switch (channel)
  73   1          {
  74   2          case TIMER0:
  75   2              TCON  |= (1 << 4); // enable timer0
  76   2              break;
  77   2          case TIMER1:
  78   2              TCON  |= (1 << 6); // enable timer1
  79   2          case TIMER2:
  80   2              T2CON |= (1 << 2); // enable time2
  81   2          case TIMER3:
  82   2              T3CON |= (1 << 3); // enable time3
  83   2          default:
  84   2              break;
  85   2          }
  86   1      }
  87          
  88          /**
  89           * @func   PWM_Start
  90           * @brief  None
  91           * @param  
  92           * @retval None
  93           */
  94          void TIMER_Disable(TimerChanel channel)
  95          {
  96   1          switch (channel)
  97   1          {
  98   2          case TIMER0:
  99   2              TCON  &= ~(1 << 4); // enable timer0
 100   2              break;
 101   2          case TIMER1:
 102   2              TCON  &= ~(1 << 6); // enable timer1
 103   2          case TIMER2:
 104   2              T2CON &= ~(1 << 2); // enable time2
 105   2          case TIMER3:
 106   2              T3CON &= ~(1 << 3); // enable time3
 107   2          default:
 108   2              break;
 109   2          }
 110   1      }
 111          
 112          /**
 113           * @func   Timer0Overflow_ISR
 114           * @brief  None
 115           * @param  
C51 COMPILER V9.60.0.0   TIMER                                                             05/22/2021 13:58:10 PAGE 3   

 116           * @retval None
 117           */
 118          void Timer0Overflow_ISR(void) interrupt 1
 119          {
 120   1          if(p_timerCallBack != NULL)
 121   1          {
 122   2              p_timerCallBack();
 123   2          }
 124   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    290    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     11    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
