C51 COMPILER V9.60.0.0   IRF                                                               05/15/2021 18:01:58 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE IRF
OBJECT MODULE PLACED IN .\Objects\irf.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\Mid\irf.c LARGE OPTIMIZE(0,SPEED) BROWSE INCDIR(..\App;..\Common;..\D
                    -river;..\Mid;..\Utilities) DEBUG OBJECTEXTEND PRINT(.\Listings\irf.lst) OBJECT(.\Objects\irf.obj)

line level    source

   1          /*
   2           * Copyright (c) 2021
   3           * Team, JSC.
   4           * All Rights Reserved
   5           *
   6           *
   7           * Description:
   8           *
   9           * Author: Truongvv
  10           *
  11           * Last Changed By:  $Author: Truongvv $
  12           * Revision:         $Revision: 1.0 $
  13           * Last Changed:     $Date: x/x/xxxx $
  14           */
  15          #include "N76E003.h"
  16          #include "SFR_Macro.h"
  17          #include "Function_Define.h"
  18          #include "irfapp_main.h"
  19          #include "Irf.h"
  20          #include "uart.h"
  21          #include "queue.h"
  22          #include "xor.h"
  23          
  24          QUEUEx_t    irf_CommandQueue;
  25          irf_Command_t irf_CommandBuff[IRF_QUEUE_MAX];
  26          extern volatile int checkStopCmd;
  27          /******************************************************************************/
  28          /*                            FUNCTIONS                              */
  29          /******************************************************************************/
  30          static void IRF_CallBackHandle(void);
  31          
  32          /**
  33           * @func    IRF_Init
  34           * @brief   None
  35           * @param   None
  36           */
  37          void IRF_Init(void)
  38          {
  39   1          UART_Init(UART_BAUDRATE);
  40   1          UART_CallBackInit(IRF_CallBackHandle);
  41   1          QUEUE_Init(&irf_CommandQueue, (u8*)irf_CommandBuff,\
  42   1                      IRF_QUEUE_MAX, sizeof(irf_Command_t));
  43   1          UART_Enable();
  44   1      }
  45          
  46          /**
  47           * @func    IRF_CallBackHandle
  48           * @brief   None
  49           * @param   None
  50           */
  51          static void IRF_CallBackHandle(void)
  52          {
  53   1          static u8 revByte = 0;
  54   1          static u16 revByteCount = 0;
C51 COMPILER V9.60.0.0   IRF                                                               05/15/2021 18:01:58 PAGE 2   

  55   1          u8 revBuff[IRF_HEADER + IRF_BUFF_MAX + 1];
  56   1          u8 sendError[5];
  57   1          revByte = UART_RevData();
  58   1          revBuff[revByteCount++] = revByte;
  59   1          /* Check if cmd is stop then do not queue*/
  60   1          if (revBuff[0] == 0x40)
  61   1          {
  62   2              checkStopCmd = 1;
  63   2          }
  64   1          if(revByteCount >= IRF_HEADER)
  65   1          {
  66   2              if(revByteCount == (IRF_HEADER + revBuff[3] + 1))
  67   2              {
  68   3                  if(revBuff[IRF_HEADER + revBuff[3]] == XOR_Caculator(revBuff, 0, IRF_HEADER + revBuff[3]))
  69   3                  {
  70   4                      QUEUE_Push(&irf_CommandQueue, revBuff);
  71   4                  }
  72   3                  else
  73   3                  {
  74   4                      UART_SendData("RJ");
*** WARNING C209 IN LINE 74 OF ..\Mid\irf.c: '_UART_SendData': too few actual parameters
  75   4                  }
  76   3                  revByteCount = 0;
  77   3              }
  78   2          }
  79   1      }
*** WARNING C280 IN LINE 56 OF ..\Mid\irf.c: 'sendError': unreferenced local variable
  80          
  81          /**
  82           * @func    IRF_Proc
  83           * @brief   None
  84           * @param   None
  85           */
  86          void IRF_Proc(void)
  87          {
  88   1          irf_Command_t irf_CommandBuff;
  89   1          if(!QUEUE_Empty(&irf_CommandQueue))
  90   1          {
  91   2              QUEUE_Get(&irf_CommandQueue, (u8*)&irf_CommandBuff);
  92   2              APP_CheckCommandExistAndExecutes(\
  93   2                  irf_CommandBuff.command, irf_CommandBuff.type,\
  94   2                  irf_CommandBuff.buff, irf_CommandBuff.length); 
  95   2          }
  96   1      }
  97          
  98          /**
  99           * @func    IRF_Send
 100           * @brief   None
 101           * @param   None
 102           */
 103          void IRF_Send(u8* buff, u8 length)
 104          {
 105   1          UART_SendData(buff, length);
 106   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    414    ----
   CONSTANT SIZE    =      3    ----
   XDATA SIZE       =     59    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
C51 COMPILER V9.60.0.0   IRF                                                               05/15/2021 18:01:58 PAGE 3   

   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
