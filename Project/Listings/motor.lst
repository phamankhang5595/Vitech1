C51 COMPILER V9.60.0.0   MOTOR                                                             06/13/2021 10:03:35 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MOTOR
OBJECT MODULE PLACED IN .\Objects\motor.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\Mid\motor.c LARGE OPTIMIZE(0,SPEED) BROWSE INCDIR(..\App;..\Common;..
                    -\Driver;..\Mid;..\Utilities) DEBUG OBJECTEXTEND PRINT(.\Listings\motor.lst) OBJECT(.\Objects\motor.obj)

line level    source

   1          /*
   2           *  motor.c
   3           *
   4           *  Created on: Dec 25, 2020
   5           *      Author: Truong VV
   6           */
   7          
   8          #include "N76E003.h"
   9          #include "SFR_Macro.h"
  10          #include "Function_Define.h"
  11          #include "motor.h"
  12          #include "pwm.h"
  13          #include "delay.h"
  14          
  15          volatile int checkStopCmd = 0;
  16          /******************************************************************************/
  17          /*                              FUNCTION                                      */
  18          /******************************************************************************/
  19          
  20          /**
  21           * @func    MOTOR_Config
  22           * @brief   None
  23           * @param   None
  24           */
  25          void MOTOR_Config(void)
  26          {
  27   1          PWM_PinInit();
  28   1          delay_ms(500);
  29   1      }
  30          /**
  31           * @func    MOTOR_Init
  32           * @brief   None
  33           * @param   None
  34           */
  35          void MOTOR_Init(uint16_t defaultDuty)
  36          {
  37   1          PWM_Init();
  38   1          PWM_SetDuty(defaultDuty);
  39   1      }
  40          /**
  41           * @func    MOTOR_GetCurrentSpeed
  42           * @brief   None
  43           * @param   None
  44           */
  45          uint16_t MOTOR_GetCurrentSpeed(void)
  46          {
  47   1          return ((PWM2H << 8) | (PWM2L));
  48   1      }
  49          /**
  50           * @func    MOTOR_SetSpeed
  51           * @brief   None
  52           * @param   None
  53           */
  54          void MOTOR_SetSpeed(uint16_t currentDuty, uint16_t desireDuty)
C51 COMPILER V9.60.0.0   MOTOR                                                             06/13/2021 10:03:35 PAGE 2   

  55          {
  56   1          uint16_t i = 0;
  57   1          if(currentDuty > desireDuty)
  58   1          {
  59   2              for(i = currentDuty; i > desireDuty && checkStopCmd != 1; i--)
  60   2              {
  61   3                  PWM_SetDuty(i);
  62   3                  delay_ms(20);
  63   3              }
  64   2          }else
  65   1          {
  66   2              for(i = currentDuty; i < desireDuty && checkStopCmd != 1; i++)
  67   2              {
  68   3                  PWM_SetDuty(i);
  69   3                  delay_ms(20);
  70   3              }
  71   2          }
  72   1          checkStopCmd = 0;
  73   1      }
  74          void MOTOR_SetStop(uint16_t currentDuty)
  75          {
  76   1          uint16_t i = 0;
  77   1          for(i = currentDuty; i > DEFAULTDUTY ; i--)
  78   1          {
  79   2              PWM_SetDuty(i);
  80   2              delay_ms(20);
  81   2          }
  82   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    375    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     14    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
